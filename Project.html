<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>ìˆ¨ì€ ì´ë¯¸ì§€ ì°¾ê¸° ê²Œì„</title>

    <style>
      body {
        background: LightCoral;
      }
      div#title {
        margin: 0px auto; /*ê°€ìš´ë° ì •ë ¬*/
        font-size: 30px; /*í°íŠ¸ ì‚¬ì´ì¦ˆ , êµµê¸°, ìƒ‰, ìœ„ì¹˜ ì„¤ì •*/
        font-weight: 750;
        color: white;
        text-align: center;
      }
      span#bgm {
        margin: 0px auto; /*ê°€ìš´ë° ì •ë ¬*/
        font-size : 30px;
      }
      tr > td.pos {
        padding: 0px;
      }
      table, img, h3{
        display : inline-block;
      }
      #score {
        background:linen;
      }
    </style>

    <script>
    var row=3, col=8;

    var start, rest, fail, time, inform, restartButton, soundButton; //ê²Œì„ ì •ë³´ ì œê³µ íƒœê·¸ë“¤
    var rest_count, fail_count; // ê°ê° ë‚¨ì€ ìˆ˜, ì‹¤íŒ¨ ìˆ˜
    var time_game, time_img; //ì „ì²´ ê²Œì„ ì‹œê°„, ìˆ¨ì€ ì´ë¯¸ì§€ ë³´ì—¬ì£¼ëŠ” ì‹œê°„
    var t_Game, t_Img// ê²Œì„ ì‹œê°„ê³¼ ì •ë‹µ ì´ë¯¸ì§€ê°€ ë³´ì—¬ì§€ëŠ” ì‹œê°„ setInterval ê°ì²´
    var position; //cellë“¤ì˜ collection
    var resetImg="C:\\web_prog\\media\\Project_media\\Image.jpg"; //ê¸°ë³¸ ì‚¬ì§„
    var answerImg="C:\\web_prog\\media\\Project_media\\answerImage.jpg"; //ì •ë‹µ ì‚¬ì§„
    var bgm = new Audio("C:\\web_prog\\media\\Project_media\\projectMusic.mp4"); //ë°°ê²½ìŒì•…

    var isLoading = false; //ê²Œì„ ì¤€ë¹„ í™•ì¸
    var isGaming = false; //ê²Œì„ ì¤‘ì¸ì§€ í™•ì¸
    var soundOn = true; //ë°°ê²½ìŒì•… ì¬ìƒì¤‘ì¸ì§€ í™•ì¸

      function load(){
        start=document.getElementById("start"); //ëˆ„ë¥´ë©´ ê²Œì„ ì‹œì‘
        rest=document.getElementById("rest"); //ë‚¨ì€ ìˆ˜
        fail=document.getElementById("fail"); //ì‹¤íŒ¨ ìˆ˜
        time=document.getElementById("time"); //ë‚¨ì€ ì‹œê°„
        inform=document.getElementById("inform"); //ê²Œì„ ì •ë³´ ì œê³µ
        restartButton=document.getElementById("restart"); //ë‹¤ì‹œ ì‹œì‘ ë²„íŠ¼
        soundButton=document.getElementById("bgm"); //ë°°ê²½ìŒì•… ì œì–´ ë²„íŠ¼


        var gameScreen=document.getElementById("gameScreen"); //gameScreen=>ê²Œì„ì„ ì§„í–‰í•  í™”ë©´
        var table=document.createElement("table"); //ê²Œì„ í™”ë©´ì— tableíƒœê·¸ ìƒì„±í›„, gameScreenì˜ ìì‹ íƒœê·¸ë¡œ ì‚½ì…
        gameScreen.appendChild(table);

        for(i=0; i<row; i++){
          var tr=document.createElement("tr") //tríƒœê·¸ ìƒì„± í›„, tableì˜ ìì‹ íƒœê·¸ë¡œ ì‚½ì…
          table.appendChild(tr);

          for(j=0; j<col; j++){
            var td=document.createElement("td"); //tdíƒœê·¸ ìƒì„± í›„, trì˜ ìì‹ íƒœê·¸ë¡œ ì‚½ì…
            td.style.width="140px"; //tdì˜ ë„“ì´ì™€ ë†’ì´->ê°ê° 161px
            td.style.height="140px";
            td.style.border = "0.2px solid LightCoral"; //tdì˜ ê²½ê³„-> 0.2px ë‘ê»˜, êµµì€ ì„  í˜•íƒœ, LightCoralìƒ‰
            td.style.backgroundColor="white"; //tdì˜ ë°°ê²½ìƒ‰->white
            tr.appendChild(td);

            var img=document.createElement("img"); //imgíƒœê·¸ ìƒì„± í›„, tdì˜ ìì‹ íƒœê·¸ë¡œ ì‚½ì…
            img.setAttribute("src", resetImg); //img íƒœê·¸ì˜ src=resetImg
            img.setAttribute("class", "pos"); //img íƒœê·¸ì˜ class="pos"
            img.setAttribute("alt", "cell"); //img íƒœê·¸ì˜ alt="cell"
            img.setAttribute("onclick", "guess(this)"); //img íƒœê·¸ì˜ onclickì´ë²¤íŠ¸ ë°œìƒì‹œ, guess(this)í•¨ìˆ˜ ì‹¤í–‰
            td.appendChild(img);
          }
        }

        position=document.getElementsByClassName("pos"); //ì „ì²´ cell collection
      }// end of load

      function timerGame(){ //ì „ì²´ ê²Œì„ ì‹œê°„
        --time_game;
        time.innerHTML="ë‚¨ì€ ì‹œê°„: " + time_game;

        if(time_game < 0){
          loseGame();
        }
      }//end function timerGame

      function timerImg(){ //ìˆ¨ì€ ì´ë¯¸ì§€ ë³´ì—¬ì£¼ëŠ” ì‹œê°„
        --time_img;
        inform.innerHTML="**ë‹¤ë¥¸ ì´ë¯¸ì§€ì˜ ìœ„ì¹˜ë¥¼ ê¸°ì–µí•˜ì„¸ìš”**<br />" + time_img +"ì´ˆ í›„ ì´ë¯¸ì§€ê°€ ì‚¬ë¼ì§‘ë‹ˆë‹¤.";

        if(time_img <= 0){
          clearInterval(t_Img);
          inform.innerHTML="**ë‚¨ì€ ì‹œê°„ë™ì•ˆ ë‹¤ë¥¸ ì´ë¯¸ì§€ì˜ ìœ„ì¹˜ë¥¼ ì°¾ìœ¼ì„¸ìš”**";
        }
      }//end of showImg

      function startGame(){ //ê²Œì„ ì‹œì‘ ë²„íŠ¼ ëˆŒë ¸ì„ ë•Œ
        if(isGaming) return; //ì´ë¯¸ ê²Œì„ ì¤‘ì´ë¼ë©´ ê²Œì„ì‹œì‘ ë¶ˆê°€ëŠ¥
        bgm.play(); //ë°°ê²½ìŒì•… ìë™ ì‹¤í–‰

        alert("                 -----------------ê²Œì„ ê·œì¹™-----------------\n                    **ê½ƒ ì´ë¯¸ì§€ì˜ ìœ„ì¹˜ë¥¼ ê¸°ì–µí•˜ì„¸ìš”** \n                        ì‹¤íŒ¨ìˆ˜ê°€ 8ì´ìƒì´ë©´ ê²Œì„ ì‹¤íŒ¨!");
        isGaming=true;
        rest_count=8; fail_count=0; //ì´ˆê¸°ê°’ ë‚¨ì€ ìˆ˜:8  ì‹¤íŒ¨ ìˆ˜:0  ì „ì²´ ê²Œì„ ì‹œê°„:25  ì •ë‹µ ì´ë¯¸ì§€ ë³´ì—¬ì£¼ëŠ” ì‹œê°„:10
        time_game=25; time_img=10;
        start.innerHTML="ê²Œì„ ì§„í–‰ì¤‘ . . .";
        inform.innerHTML="**ë‹¤ë¥¸ ì´ë¯¸ì§€ì˜ ìœ„ì¹˜ë¥¼ ê¸°ì–µí•˜ì„¸ìš”**<br />" + time_img + "ì´ˆ í›„ ì´ë¯¸ì§€ê°€ ì‚¬ë¼ì§‘ë‹ˆë‹¤.";
        rest.innerHTML="ë‚¨ì€ìˆ˜: " + rest_count;
        fail.innerHTML="ì‹¤íŒ¨ìˆ˜: " + fail_count;
        time.innerHTML="ë‚¨ì€ ì‹œê°„: " + time_game;
        showHiddenImg(); // ì •ë‹µ ì´ë¯¸ì§€ ë³´ì—¬ì£¼ëŠ” í•¨ìˆ˜
        t_Game=setInterval("timerGame()", 1000); //1ì´ˆ ê°„ê²©ìœ¼ë¡œ timer()ì‹¤í–‰
        t_Img=setInterval("timerImg()", 1000); //1ì´ˆ ê°„ê²©ìœ¼ë¡œ showImg()ì‹¤í–‰

      }//end of startGame

      function showHiddenImg(){ //ëœë¤ìœ¼ë¡œ ì •ë‹µ ì´ë¯¸ì§€ ì§€ì •í•˜ëŠ” í•¨ìˆ˜
        var count=0;
        while(count < rest_count){
          var idx=Math.floor(Math.random()*23);
          if(position[idx].alt=="Answer") continue; //ì •ë‹µ ì´ë¯¸ì§€ê°€ ì¤‘ë³µëœ ìœ„ì¹˜ì¼ë•Œ continue
          position[idx].src=answerImg; //ì •ë‹µ ì´ë¯¸ì§€ë¡œ ë³€ê²½
          position[idx].alt="Answer"; //altê°’ì„ ë³€ê²½í•˜ì—¬ ë‹¤ë¥¸ ê¸°ë³¸ cellë“¤ê³¼ êµ¬ë¶„ ê°€ëŠ¥
          count++;
        }
        setTimeout("screenReset()", time_img*1000); //time_imgì¸ 10ì´ˆ í›„ screenReset()ì‹¤í–‰
      }//end of showHiddenImg

      function screenReset() { //ê²Œì„ì„ ìœ„í•´ ì •ë‹µ ì´ë¯¸ì§€ë¥¼ ë‹¤ì‹œ ê¸°ë³¸ ì´ë¯¸ì§€ë¡œ ë³€ê²½í•˜ëŠ” í•¨ìˆ˜
        for(var i=0; i<position.length; i++){
          if(position[i].alt=="Answer"){ //altê°’ì„ ì´ìš©í•˜ì—¬ ì •ë‹µì´ë¯¸ì§€ì˜ srcë¥¼ resetImgë¡œ ì„¤ì •
            position[i].src=resetImg;
          }
        }
        isLoading = true; //ê²Œì„ ì¤€ë¹„ ì™„ë£Œ
      }// end of screenReset

      function guess(cell){ //ì •ë‹µ ì´ë¯¸ì§€ì¸ì§€ í™•ì¸
        if (!isLoading) return; //ì •ë‹µ ì´ë¯¸ì§€ê°€ resetë˜ê¸° ì „ ëˆ„ë¥¸ ê²ƒì€ return

        if(cell.alt=="Answer"){ //ì •ë‹µ ì´ë¯¸ì§€ë¼ë©´->right_cell() ì‹¤í–‰
          right_cell(cell);
        }
        else{ //ì •ë‹µ ì´ë¯¸ì§€ê°€ ì•„ë‹ˆë¼ë©´->wrong_cell() ì‹¤í–‰
          wrong_cell(cell);
        }
      } //end of guess

      function right_cell(cell) {
        cell.src = answerImg; //ì •ë‹µ ì´ë¯¸ì§€ í‘œì‹œ
        cell.alt = "correct"; //altì†ì„± ë³€ê²½. ()ì•„ì§ ë§ì¶”ì§€ ëª»í•œ ì •ë‹µ ì´ë¯¸ì§€ì™€ ë§ì¶˜ ì •ë‹µì´ë¯¸ì§€ë¥¼ êµ¬ë¶„í•˜ê¸° ìœ„í•´)
        rest_count--; //ë‚¨ì€ ìˆ˜ -1
        rest.innerHTML="ë‚¨ì€ìˆ˜: "+rest_count;
        if(rest_count == 0) winGame(); //ë‚¨ì€ ìˆ˜ê°€ 0->winGame() ì‹¤í–‰
      }//end of right_cell

      function wrong_cell(cell) {
        fail_count++; //ì‹¤íŒ¨ìˆ˜ +1
        fail.innerHTML="ì‹¤íŒ¨ìˆ˜: "+fail_count;
        if(fail_count > 7) loseGame(); //ì‹¤íŒ¨ ìˆ˜ê°€ 8ì´ìƒì´ë©´->loseGame()ì‹¤í–‰
      }//end of wrong_cell

      function winGame() {
        clearInterval(t_Game); //ë°˜ë³µ í•´ì œ
        start.innerHTML="ê²Œì„ ìŠ¹ë¦¬";
        time.innerHTML="ë‚¨ì€ ì‹œê°„: " + time_game;
        inform.innerHTML="â†“ë‹¤ì‹œ ì‹œì‘ ë²„íŠ¼â†“ ";
        restartButton.style.display = "inline-block"; //ê²Œì„ ì¢…ë£Œ í›„ì—ëŠ” ë‹¤ì‹œ ì‹œì‘ ë²„íŠ¼ ë³´ì´ê²Œ ì„¤ì •
        setTimeout(function() { //alertê°€ í™”ë©´ì— ë¨¼ì € ì¶œë ¥ë˜ëŠ” ê²ƒì„ ë§‰ê¸° ìœ„í•´ setTimeout()ì‹¤í–‰
          alert("Win!");
        }, 200);
      }//end of winGame

      function loseGame() {
        clearInterval(t_Game); //ë°˜ë³µ í•´ì œ
        start.innerHTML="ê²Œì„ ì¢…ë£Œ";
        if(fail_count > 7) time.innerHTML = "Fail Count Over"
        else time.innerHTML="Time out";
        inform.innerHTML="â†“ë‹¤ì‹œ ì‹œì‘ ë²„íŠ¼â†“ ";
        let remains = document.querySelectorAll("img[alt='Answer']"); //ì œí•œ ì‹œê°„ ì•ˆì— ë§ì¶”ì§€ ëª»í•œ ì •ë‹µ ì´ë¯¸ì§€ collection
        for (let i=0; i<remains.length; i++) {
          remains[i].parentNode.style.border = "3px solid red"; //ë¹¨ê°„ìƒ‰ ê²½ê³„ë¥¼ í‘œì‹œí•˜ê³  ì •ë‹µ ì´ë¯¸ì§€ë¡œ ë³€ê²½í•˜ë©´ì„œ ìœ„ì¹˜ í‘œì‹œ
          remains[i].src=answerImg;
        }
        restartButton.style.display = "inline-block"; //ë‹¤ì‹œ ì‹œì‘ ë²„íŠ¼ ë³´ì´ê²Œ ì„¤ì •

        setTimeout(function() { //alertê°€ í™”ë©´ì— ë¨¼ì € ì¶œë ¥ë˜ëŠ” ê²ƒì„ ë§‰ê¸° ìœ„í•´ setTimeout()ì‹¤í–‰
          alert("Game over!");
        }, 200);
      }//end of loseGame

      function restart() { //ë‹¤ì‹œ ì‹œì‘ ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ
        isGaming = false;
        soundOn = false;
        for(i=0; i<position.length; i++){ //ëª¨ë“  ê°’ ì´ˆê¸°í™”
          position[i].src=resetImg;
          position[i].alt="cell";
          position[i].parentNode.style.border = "0.2px solid LightCoral";
        }
        //bgm.muted = true;
        restartButton.style.display="none"; //ë‹¤ì‹œ ì‹œì‘ ë²„íŠ¼ ë³´ì´ì§€ ì•Šê²Œ ì„¤ì •

        startGame(); //startGame()ì‹¤í–‰
      }//end of restart

      function controlSound(){
        if(!isGaming) return; //ê²Œì„ ì‹œì‘ ì „ ë°°ê²½ìŒì•… ì¬ìƒ ì œì–´ ë¶ˆê°€ëŠ¥
        if(soundOn) { //ë°°ê²½ìŒì•…ì´ ì¼œì ¸ìˆì—ˆë‹¤ë©´
          soundOn = false;
          bgm.muted = true;
          soundButton.innerHTML = "ğŸ”‡";
        }
        else if(!soundOn) { // ë°°ê²½ìŒì•…ì´ êº¼ì ¸ìˆì—ˆë‹¤ë©´
          soundOn = true;
          bgm.muted = false;
          soundButton.innerHTML = "ğŸ”Š";
        }
      }

    </script>
  </head>
  <body onload="load()">
    <span id="bgm" onclick="controlSound()">ğŸ”Š</span>
    <div id="title">
      ë‹¤ë¥¸ ì´ë¯¸ì§€ ì°¾ê¸°
    </div>
    <hr>
    <div id="gameScreen">
      <table id="score">
        <tr><td id="start" style="background-color:yellow" onclick="startGame()">ê²Œì„ì‹œì‘</td></tr>
        <tr><td id="rest">ë‚¨ì€ìˆ˜ </td></tr>
        <tr><td id="fail">ì‹¤íŒ¨ìˆ˜ </td></tr>
        <tr><td id="time">ë‚¨ì€ ì‹œê°„ </td></tr>
        <tr><td id="inform">ê²Œì„ì´ ì§„í–‰ë  ì˜ˆì •ì…ë‹ˆë‹¤.</td></tr>
        <tr><td><input type="button" id="restart" style="display: none;" value="restart" onclick="restart()"></td></tr>
      </table>
    </div>
  </body>
</html>
